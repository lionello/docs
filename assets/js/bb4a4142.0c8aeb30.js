"use strict";(self.webpackChunkplatformatic_oss_website=self.webpackChunkplatformatic_oss_website||[]).push([[96584],{93535:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var n=a(85893),s=a(11151);const i={},o="Seed a Database",r={id:"guides/seed-a-database",title:"Seed a Database",description:"A database is as useful as the data that it contains: a fresh, empty database",source:"@site/versioned_docs/version-1.21.1/guides/seed-a-database.md",sourceDirName:"guides",slug:"/guides/seed-a-database",permalink:"/docs/1.21.1/guides/seed-a-database",draft:!1,unlisted:!1,editUrl:"https://github.com/platformatic/oss/edit/main/versioned_docs/version-1.21.1/guides/seed-a-database.md",tags:[],version:"1.21.1",frontMatter:{},sidebar:"docs",previous:{title:"Advanced Fly.io Deployment",permalink:"/docs/1.21.1/guides/deployment/advanced-fly-io-deployment"},next:{title:"Add Custom Functionality",permalink:"/docs/1.21.1/guides/add-custom-functionality/introduction"}},d={},c=[{value:"Example",id:"example",level:2}];function l(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h1,{id:"seed-a-database",children:"Seed a Database"}),"\n",(0,n.jsx)(t.p,{children:"A database is as useful as the data that it contains: a fresh, empty database\nisn't always the best starting point. We can add a few rows from our migrations\nusing SQL, but we might need to use JavaScript from time to time."}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.a,{href:"/docs/1.21.1/reference/cli#seed",children:"platformatic db seed"}),' command allows us to run a\nscript that will populate \u2014 or "seed" \u2014 our database.']}),"\n",(0,n.jsx)(t.h2,{id:"example",children:"Example"}),"\n",(0,n.jsxs)(t.p,{children:["Our seed script should export a ",(0,n.jsx)(t.code,{children:"Function"})," that accepts an argument:\nan instance of ",(0,n.jsx)(t.a,{href:"/docs/1.21.1/reference/sql-mapper/introduction",children:(0,n.jsx)(t.code,{children:"@platformatic/sql-mapper"})}),"."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-javascript",metastring:'title="seed.js"',children:"'use strict'\n\nmodule.exports = async function seed ({ entities, db, sql }) {\n  await entities.graph.save({ input: { name: 'Hello' } })\n  await db.query(sql`\n    INSERT INTO graphs (name) VALUES ('Hello 2');\n  `)\n}\n"})}),"\n",(0,n.jsx)(t.p,{children:"For Typescript use the following stub"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-typescript",metastring:'title="seed.ts"',children:"/// <reference path=\"./global.d.ts\" />\nimport { Entities } from '@platformatic/sql-mapper'\n\nconst movies: object[] = [\n  { title: 'Harry Potter' },\n  { title: 'The Matrix' }\n]\n\nexport async function seed (opts: { entities: Entities }) {\n  for (const movie of movies) {\n    await opts.entities.movie.save({ input: movie })\n  }\n}\n"})}),"\n",(0,n.jsx)(t.admonition,{type:"info",children:(0,n.jsxs)(t.p,{children:["Platformatic code will look for a ",(0,n.jsx)(t.code,{children:"default"})," or ",(0,n.jsx)(t.code,{children:"seed"})," function name when importing the file. Take a look at the ",(0,n.jsx)(t.code,{children:"execute"})," function ",(0,n.jsx)(t.a,{href:"https://github.com/platformatic/platformatic/blob/main/packages/db/lib/seed.mjs",children:"here"})]})}),"\n",(0,n.jsx)(t.p,{children:"We can then run the seed script with the Platformatic CLI:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"npx platformatic db seed seed.js\n"})})]})}function p(e={}){const{wrapper:t}={...(0,s.a)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},11151:(e,t,a)=>{a.d(t,{Z:()=>r,a:()=>o});var n=a(67294);const s={},i=n.createContext(s);function o(e){const t=n.useContext(i);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(i.Provider,{value:t},e.children)}}}]);